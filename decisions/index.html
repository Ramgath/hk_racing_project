
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ramgath.github.io/hk_racing_project/decisions/">
      
      
        <link rel="prev" href="../master-plan/">
      
      
        <link rel="next" href="../project-status/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Decisions - HK Racing Project</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/overrides.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#key-project-decisions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="HK Racing Project" class="md-header__button md-logo" aria-label="HK Racing Project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            HK Racing Project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Decisions
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="HK Racing Project" class="md-nav__button md-logo" aria-label="HK Racing Project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    HK Racing Project
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../master-plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Project Plan
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Decisions
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Decisions
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#week-1-2025-05-04" class="md-nav__link">
    <span class="md-ellipsis">
      WEEK 1: 2025-05-04
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#week-2-2025-05-11" class="md-nav__link">
    <span class="md-ellipsis">
      WEEK 2: 2025-05-11
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#week-3-2025-05-18" class="md-nav__link">
    <span class="md-ellipsis">
      WEEK 3: 2025-05-18
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#week-4-2025-05-25" class="md-nav__link">
    <span class="md-ellipsis">
      WEEK 4: 2025-05-25
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../project-status/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Project Status
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../project-accomplishments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accomplishments
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Phases
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Phases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../phase-01-collection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P1-collection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../phase-02-cleansing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Phase 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../phase-03-eda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Phase 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../phase-04-features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Phase 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../phase-05-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Phase 5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../phase-06-evaluation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Phase 6
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../phase-07-deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Phase 7
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../phase-08-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Phase 8
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#week-1-2025-05-04" class="md-nav__link">
    <span class="md-ellipsis">
      WEEK 1: 2025-05-04
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#week-2-2025-05-11" class="md-nav__link">
    <span class="md-ellipsis">
      WEEK 2: 2025-05-11
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#week-3-2025-05-18" class="md-nav__link">
    <span class="md-ellipsis">
      WEEK 3: 2025-05-18
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#week-4-2025-05-25" class="md-nav__link">
    <span class="md-ellipsis">
      WEEK 4: 2025-05-25
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="key-project-decisions">Key Project Decisions</h1>
<p>This document tracks the major design and process decisions for the HK Racing Project, along with context and rationale.</p>
<hr />
<h3 id="week-1-2025-05-04">WEEK 1: 2025-05-04</h3>
<ul>
<li>
<p><strong>Decision:</strong> <strong>Define primary development environment roles: VS Code for core development, Google Colab for EDA &amp; intensive ML.</strong></p>
<ul>
<li><strong>Rationale:</strong> Leverages VS Code's strengths for project management &amp; script development, and Colab's strengths for experimentation &amp; hardware acceleration. Clear separation of concerns. (Alternatives: Using only Colab; Using only VS Code).</li>
</ul>
</li>
<li>
<p><strong>Decision:</strong> <strong>Adopt direct Python-to-BigQuery for raw data ingestion.</strong></p>
<ul>
<li><strong>Rationale:</strong> Increases robustness, scalability, and efficiency of the automated scraping pipeline. Reduces manual steps and potential points of failure associated with Sheets intermediary. (Alternatives: Google Sheets as intermediary for raw data; Local files then upload to BQ).</li>
</ul>
</li>
<li>
<p><strong>Decision:</strong> <strong>Implement data corrections in BigQuery via Python scripts.</strong></p>
<ul>
<li><strong>Rationale:</strong> Scripted corrections are version-controllable, auditable, and more robust. A GSheet for <em>logging</em> corrections could be a future UI enhancement if needed. (Alternatives: Direct manual edits in BQ console; Google Sheet as a UI for triggering updates).</li>
</ul>
</li>
<li>
<p><strong>Decision:</strong> <strong>Use Google Cloud Storage (GCS) for storing trained model artifacts.</strong></p>
<ul>
<li><strong>Rationale:</strong> GCS offers better versioning, programmatic access, and integration with MLOps tools (like Vertex AI Model Registry). Likely free/low-cost for project scale. (Alternatives: Google Drive; Storing models directly in the Git repository).</li>
</ul>
</li>
<li>
<p><strong>Decision:</strong> <strong>Utilize Vertex AI Model Registry for model versioning and metadata.</strong></p>
<ul>
<li><strong>Rationale:</strong> Provides a centralized, free (for registration) service for managing model lifecycle, improving organization and reproducibility. Points to models in GCS. (Alternatives: Manual tracking in spreadsheets; Custom solution).</li>
</ul>
</li>
<li>
<p><strong>Decision:</strong> <strong>Defer dashboarding; consider Streamlit for future results presentation.</strong></p>
<ul>
<li><strong>Rationale:</strong> Focus on core pipeline first. Streamlit offers a Python-native way to quickly build interactive UIs when predictions are ready. (Alternatives: Dash; Custom HTML/JS; GitHub Pages for static reports).</li>
</ul>
</li>
<li>
<p><strong>Decision:</strong> <strong>Implement <code>config/</code> directory with <code>config.yaml</code> (gitignored) and <code>config.yaml.example</code> for project settings.</strong></p>
<ul>
<li><strong>Rationale:</strong> Centralizes configuration, improves clarity, facilitates different environments (if needed later), and keeps secrets out of version control. (Alternatives: Hardcoding configurations; Environment variables only).</li>
</ul>
</li>
<li>
<p><strong>Decision:</strong> <strong>Create <code>src/common/config_loader.py</code> for loading YAML configurations.</strong></p>
<ul>
<li><strong>Rationale:</strong> Provides a standardized, reusable way to access configurations throughout the project. (Alternatives: Ad-hoc loading in multiple scripts).</li>
</ul>
</li>
</ul>
<p><strong>Coherence Summary for Week 1:</strong> The decisions in Week 1 collectively establish a robust MLOps foundation. They define clear roles for development environments (VS Code, Colab), establish a direct and script-based data ingestion and correction pipeline (Python to BigQuery), and set up best practices for model artifact storage and versioning (GCS, Vertex AI Model Registry). Configuration management is also addressed systematically. This coherent set of choices prioritizes automation, scalability, and reproducibility from the project's inception, focusing on building a solid technical backbone before tackling UI or dashboarding aspects.</p>
<hr />
<h3 id="week-2-2025-05-11">WEEK 2: 2025-05-11</h3>
<ul>
<li>
<p><strong>Decision:</strong> <strong>Manage <code>project-status.md</code> manually instead of script-based generation from Google Sheets for detailed tasks.</strong></p>
<ul>
<li><strong>Rationale:</strong> User preference for direct Markdown editing and control. Simplifies tooling if more comfortable with manual updates. (Alternatives: Python script to generate phase-specific task tables; Python script for single task table).</li>
</ul>
</li>
<li>
<p><strong>Decision:</strong> <strong>Exclude pre-2008 historical data from the project scope.</strong></p>
<ul>
<li><strong>Rationale:</strong><ol>
<li>Data is error-prone and difficult to load/validate in BigQuery.</li>
<li>Significant missing values for critical data points (win odds, horse weights, HKJC ratings).</li>
<li>Absence of sectional timings, and concerns about the accuracy of overall finish times.</li>
<li>Inconsistent false rail configurations prior to the 2008 GPS tracking system introduction, making comparisons with modern data unreliable.</li>
<li>Lack of advanced timing systems (e.g., precision to two decimal places).</li>
<li>The effort to cleanse and integrate this data outweighs the potential benefits, and focusing on 2008+ data ensures higher quality and relevance.</li>
</ol>
</li>
<li><strong>Impact:</strong> Simplifies Phase 1 data collection and Phase 2 cleansing efforts. The <code>hk_racing_historical_raw</code> BigQuery dataset will not be created.</li>
</ul>
</li>
<li>
<p><strong>Decision:</strong> <strong>Refine BigQuery Dataset Strategy for Phase 1.</strong></p>
<ul>
<li><strong><code>hk_racing_dataset</code> (Main Dataset):</strong><ul>
<li>Will store processed historical data (2008 - November 2023) ingested from user-provided Google Sheets.</li>
<li>Target schemas for tables (<code>results</code>, <code>racecard</code>, <code>race_details</code>, <code>horse_register</code>) are defined by the user in <code>Appendix A: Phase 1 Data Dictionary</code> of the <code>master-plan</code></li>
<li>This dataset will also be the target for fully cleansed and integrated analytical data in later phases.</li>
</ul>
</li>
<li><strong><code>hk_racing_scraped_raw</code> (Staging/Raw Dataset):</strong><ul>
<li>Will store raw data collected from the HKJC website (December 2023 onwards) after preliminary Python-based formatting.</li>
<li>Table structures will initially mirror the scraped data structure.</li>
</ul>
</li>
<li><strong>Rationale:</strong> Clear separation of already processed historical data from newly scraped raw data. Facilitates a focused approach for Phase 1 collection and prepares for Phase 2 cleansing and integration.</li>
<li><strong>Impact:</strong> <code>config/config.yaml</code> to be updated with <code>bq_main_dataset_id</code> and <code>bq_scraped_raw_dataset_id</code>.</li>
</ul>
</li>
<li>
<p><strong>Decision:</strong> <strong>Confirm target schemas for <code>hk_racing_dataset</code> tables.</strong></p>
<ul>
<li><strong>Source:</strong> The structure and field definitions provided by the user are adopted as the definitive schemas for the <code>results</code>, <code>racecard</code>, <code>race_details</code>, and <code>horse_register</code> tables within the <code>hk_racing_dataset</code>.</li>
<li><strong>Impact:</strong> Provides clear targets for the ingestion of processed Google Sheets data. These schemas will be documented in Appendix A of <code>master-plan.md</code>.</li>
</ul>
</li>
<li>
<p><strong>Decision:</strong> <strong>Evaluate Google Cloud Dataform for SQL transformation management in future phases.</strong></p>
<ul>
<li><strong>Rationale:</strong> For phases involving significant SQL-based data transformations within BigQuery (e.g., Phase 2: Cleansing, Phase 4: Features), Dataform offers potential benefits for version control, dependency management, testing, and orchestration of SQL workflows. This will be assessed as SQL complexity grows.</li>
<li><strong>Impact:</strong> No immediate change to Phase 1. Local Git repository remains the primary version control for all project assets. Dataform exploration is a consideration for later stages.</li>
</ul>
</li>
</ul>
<p><strong>Coherence Summary for Week 2:</strong> The decisions in Week 2 refine the project's data strategy and operational management. Key choices include scoping out problematic pre-2008 data to ensure data quality and relevance, and establishing a clear two-tiered BigQuery dataset structure (<code>hk_racing_dataset</code> for processed historical data and <code>hk_racing_scraped_raw</code> for new raw data). Confirming the schemas for the main dataset provides a solid foundation for historical data ingestion. The decision to manually manage <code>project-status.md</code> reflects a practical choice for task tracking, while the consideration of Dataform for future SQL transformations indicates forward-thinking for later project phases. These decisions collectively streamline the data collection focus and prepare for systematic data processing.</p>
<hr />
<h3 id="week-3-2025-05-18">WEEK 3: 2025-05-18</h3>
<p>The decisions made in Week 3 demonstrate a clear strategic shift to prioritize the acquisition of a rich historical dataset. They flow logically as follows:</p>
<p><strong>Strategic Pivot to Historical Data:</strong></p>
<ul>
<li><strong>Decision:</strong> Pause scraping of the live HKJC website to prioritize the acquisition of historical data from CSV files spanning 2008-2023.</li>
<li><strong>Rationale:</strong> This recognizes that a deep historical dataset is crucial for robust model training, taking precedence over immediately available current season data.</li>
<li><strong>Impact:</strong> Development focus shifts to tooling for CSV extraction, potentially delaying current data ingestion but significantly enriching the dataset's historical depth.</li>
</ul>
<p><strong>Method for Historical Data Acquisition:</strong></p>
<ul>
<li><strong>Decision:</strong> Utilize Google Colab for the one-time scraping of these historical CSV reports.</li>
<li><strong>Rationale:</strong> This approach aims to mitigate the risk of IP address blocking during a large, one-off data extraction task by leveraging Colab's environment.</li>
<li><strong>Impact:</strong> Increases the likelihood of successfully acquiring the bulk historical data without interruption.</li>
</ul>
<p><strong>Code Management for One-Off Task:</strong></p>
<ul>
<li><strong>Decision:</strong> Exclude the historical CSV scraping code from the main project repository and automated pipeline.</li>
<li><strong>Rationale:</strong> As this is a specialized, one-time task dealing with an outdated format, keeping this code separate avoids cluttering the main repository, which is focused on the ongoing, automated pipeline for current data.</li>
<li><strong>Impact:</strong> The main codebase remains lean and focused on reproducible, ongoing processes. The historical scraping script can be archived separately.</li>
</ul>
<p><strong>Coherence Summary for Week 3:</strong> These decisions coherently address a strategic goal: secure extensive historical data first. The choice of tool (Colab) supports this goal by minimizing scraping risks, and the decision on code management keeps the main project focused and clean.</p>
<hr />
<h3 id="week-4-2025-05-25">WEEK 4: 2025-05-25</h3>
<p>Week 4's decisions address the complexities arising from integrating the newly prioritized historical data with current data formats, particularly concerning textual incident reports. There's a clear progression from identifying a problem to exploring a solution and then reacting to implementation challenges:</p>
<p><strong>Addressing Data Heterogeneity:</strong></p>
<ul>
<li><strong>Decision:</strong> Formally acknowledge and plan to address the structural differences between historical race reports (comprehensive, single documents from CSVs) and current HKJC reports (more granular, incident-focused). The goal is to attempt data alignment for a cohesive longitudinal dataset.</li>
<li><strong>Rationale:</strong> To enable consistent analysis and modeling across the entire dataset (2008-present), these different data structures must be reconciled.</li>
<li>
<p><strong>Impact:</strong> This necessitates significant data wrangling and transformation efforts. The success of this alignment will heavily influence the analytical capabilities of the combined dataset.</p>
</li>
<li>
<p><strong>Decision:</strong> <strong>Redefine <code>race_calendar.py</code> (reading from a user-managed Google Sheet) as the primary trigger for the scraping pipeline for new race meetings.</strong></p>
<ul>
<li><strong>Rationale:</strong> The <code>race_calendar.py</code> script currently fetches manually entered race meeting dates. By making this script the starting point of the scraping pipeline, subsequent scraping scripts (for racecards, results, horse details, etc.) can be orchestrated to run based on the dates provided by this calendar. This centralizes control over which race meetings are targeted for scraping and automates the initiation of the process.</li>
<li><strong>Impact:</strong> The Google Sheet serving as the race calendar becomes a critical control input for the ongoing data collection pipeline. Subsequent scraping modules will be designed to consume dates/meeting information from the output of <code>race_calendar.py</code>. This decision moves the project towards a more automated and orchestrated scraping workflow for new data.</li>
</ul>
</li>
<li>
<p><strong>Decision:</strong> <strong>Incorporate "Comments on Running" reports alongside "Full Stewards' Reports" for a comprehensive incident analysis.</strong></p>
<ul>
<li><strong>Rationale:</strong> Initial inspection reveals that Full Stewards' Reports primarily detail the factual nature of incidents (e.g., "horse was bumped, stumbled, and lost lengths"). In contrast, "Comments on Running" often focus on the <em>implications</em> or consequences of these incidents from a performance perspective (e.g., "slow in the start"). Utilizing both report types will provide a more holistic understanding of incidents and their impact on a horse's race.</li>
<li><strong>Impact:</strong> This requires identifying and scraping/extracting "Comments on Running" data, which may have its own distinct format. Data integration strategies will need to account for linking these comments to specific incidents or horses from the stewards' reports. This enriches the dataset for nuanced incident-based feature engineering.</li>
</ul>
</li>
</ul>
<p><strong>Proposed Solution for Nuanced Incident Extraction:</strong></p>
<ul>
<li><strong>Decision:</strong> Utilize a reasoning model (Large Language Model via API) to interpret and categorize horse-related incidents from textual reports in the historical data.</li>
<li><strong>Rationale:</strong> This approach aims to preserve the nuances often lost in simpler rule-based extraction when trying to map comprehensive older reports to newer, granular incident structures.</li>
<li><strong>Impact:</strong> Introduces an external API dependency and potential costs but offers higher fidelity incident data.</li>
</ul>
<p><strong>Challenges and Pausing of API-Based Solution:</strong> This central decision led to a series of sub-decisions based on empirical testing and cost analysis of different LLMs:</p>
<ul>
<li>
<p><strong>Sub-Decision (Gemini Flash 1.5 Preview):</strong> Paused due to hallucination issues (specifically, it provided data related to an incorrect geographical context - South Africa - instead of using the provided Hong Kong data) and potential ongoing API costs beyond initial free tiers. This model (updated on May 20, 2025, offering 500 free prompts) was initially considered the most cost-effective and fast.</p>
<ul>
<li><strong>API Pricing:</strong><ul>
<li><strong>Non-thinking (per 1M tokens):</strong><ul>
<li>Input: $0.15</li>
<li>Output: $0.60</li>
</ul>
</li>
<li><strong>Thinking (per 1M tokens):</strong><ul>
<li>Input: $0.15</li>
<li>Output: $3.50</li>
</ul>
</li>
</ul>
</li>
<li><strong>Impact:</strong> Initial preferred cost-effective model proved unreliable for this task.</li>
</ul>
</li>
<li>
<p><strong>Sub-Decision (OpenAI GPT-4o mini):</strong> Paused due to slow processing speed and, critically, unexpectedly high "thinking" or processing token consumption (approximately 10 times the input token count). This significantly altered the projected cost, escalating it from an anticipated sub-$20 to over $200 for the required task, making it economically unviable. This was an oversight by the user, unaware that thinking tokens are included in the output token count. (An initial $20 API credit was purchased, only 50c was used, and $19.50 will be used in future if an opportunity arises, or API prices significantly decrease).</p>
<ul>
<li><strong>API Pricing (per 1M tokens):</strong><ul>
<li>Input: $1.100</li>
<li>Cached input: $0.275</li>
<li>Output: $4.400</li>
</ul>
</li>
<li><strong>Impact:</strong> A seemingly viable alternative also became economically unfeasible.</li>
</ul>
</li>
<li>
<p><strong>Sub-Decision (Gemini 2.5 Pro Preview):</strong> Paused despite being the best performer in terms of reasoning capabilities among those tested (updated May 06, 2025, offering 25 free messages per day). However, its current API costs are significantly higher than even GPT-4o mini, making it unfeasible for the bulk processing of historical incident reports at this stage.</p>
<ul>
<li><strong>API Pricing (per 1M tokens, UI remains free of charge):</strong><ul>
<li><strong>Input:</strong><ul>
<li><code>&lt;=200K tokens</code>: $1.25</li>
<li><code>&gt; 200K tokens</code>: $2.50</li>
</ul>
</li>
<li><strong>Output:</strong><ul>
<li><code>&lt;=200K tokens</code>: $10.00</li>
<li><code>&gt; 200K tokens</code>: $15.00</li>
</ul>
</li>
</ul>
</li>
<li><strong>Impact:</strong> Even the highest quality model tested is currently too expensive for this specific large-scale task.</li>
</ul>
</li>
</ul>
<p><strong>Coherence Summary for Week 4:</strong> These decisions coherently outline strategies for handling data heterogeneity (differing report structures, comprehensive incident data), including enriching incident understanding by incorporating both "Stewards' Reports" and "Comments on Running." A key operational decision redefines the <code>race_calendar.py</code> script as the trigger for a more orchestrated scraping pipeline. Furthermore, a sophisticated proposed solution for nuanced incident data extraction (LLM) was explored, leading to a data-driven rationale for pausing that solution due to model unreliability and prohibitive costs identified during testing. This demonstrates a pragmatic approach to R&amp;D, data enrichment, and pipeline automation within budget constraints. The project will proceed with other alignment tasks while the LLM-dependent component is on hold, but with a clearer path for future incident data integration and a more structured approach to ongoing data collection.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>